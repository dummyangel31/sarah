<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>福岡·由布院｜五日小旅行</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fffafa;
            color: #5d5353;
        }

        /* 柔和配色定義 */
        .theme-pink { color: #ffafcc; }
        .theme-bg-pink { background-color: #ffafcc; }
        .card-shadow {
            box-shadow: 0 12px 30px -10px rgba(255, 175, 204, 0.25);
        }

        /* 日期標籤切換效果 */
        .tab-active {
            background-color: #ffafcc !important;
            color: white !important;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(255, 175, 204, 0.4);
        }

        .scroll-hide::-webkit-scrollbar {
            display: none;
        }
        
        /* 進場動畫 */
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 時間軸裝飾線 */
        .timeline-line::before {
            content: '';
            position: absolute;
            left: 22px;
            top: 10px;
            bottom: 10px;
            width: 2px;
            background: linear-gradient(to bottom, #ffafcc 0%, #bde0fe 100%);
            opacity: 0.2;
            z-index: 0;
        }

        /* AI 載入動畫 */
        .dot-flashing {
            position: relative;
            width: 8px;
            height: 8px;
            border-radius: 5px;
            background-color: #ffafcc;
            color: #ffafcc;
            animation: dotFlashing 1s infinite linear alternate;
            animation-delay: .5s;
        }
        .dot-flashing::before, .dot-flashing::after {
            content: ''; display: inline-block; position: absolute; top: 0;
        }
        .dot-flashing::before {
            left: -12px; width: 8px; height: 8px; border-radius: 5px;
            background-color: #ffafcc; animation: dotFlashing 1s infinite alternate; animation-delay: 0s;
        }
        .dot-flashing::after {
            left: 12px; width: 8px; height: 8px; border-radius: 5px;
            background-color: #ffafcc; animation: dotFlashing 1s infinite alternate; animation-delay: 1s;
        }
        @keyframes dotFlashing {
            0% { background-color: #ffafcc; }
            50%, 100% { background-color: #fce4ec; }
        }
    </style>
</head>
<body class="pb-24">

    <!-- Header Section -->
    <header class="pt-10 pb-8 px-6 text-center">
        <h1 class="text-3xl font-bold tracking-[0.2em] text-[#d4a373] mb-2">FUKUOKA TRAVEL</h1>
        <div class="inline-block px-4 py-1 rounded-full bg-pink-50 text-pink-300 text-xs font-medium border border-pink-100">
            01/09 (五) - 01/13 (二) · 九州小散策
        </div>
    </header>

    <!-- Sticky Date Selector -->
    <nav class="sticky top-0 z-50 bg-[#fffafa]/90 backdrop-blur-lg py-4 border-b border-pink-50">
        <div class="flex overflow-x-auto px-6 space-x-4 scroll-hide justify-start md:justify-center">
            <button onclick="switchDate('01/09')" id="tab-01/09" class="date-tab flex-shrink-0 px-6 py-2.5 rounded-2xl bg-white text-gray-400 text-sm font-bold transition-all duration-300 border border-transparent shadow-sm">
                01/09 <span class="text-[10px] block opacity-60">週五</span>
            </button>
            <button onclick="switchDate('01/10')" id="tab-01/10" class="date-tab flex-shrink-0 px-6 py-2.5 rounded-2xl bg-white text-gray-400 text-sm font-bold transition-all duration-300 border border-transparent shadow-sm">
                01/10 <span class="text-[10px] block opacity-60">週六</span>
            </button>
            <button onclick="switchDate('01/11')" id="tab-01/11" class="date-tab flex-shrink-0 px-6 py-2.5 rounded-2xl bg-white text-gray-400 text-sm font-bold transition-all duration-300 border border-transparent shadow-sm">
                01/11 <span class="text-[10px] block opacity-60">週日</span>
            </button>
            <button onclick="switchDate('01/12')" id="tab-01/12" class="date-tab flex-shrink-0 px-6 py-2.5 rounded-2xl bg-white text-gray-400 text-sm font-bold transition-all duration-300 border border-transparent shadow-sm">
                01/12 <span class="text-[10px] block opacity-60">週一</span>
            </button>
            <button onclick="switchDate('01/13')" id="tab-01/13" class="date-tab flex-shrink-0 px-6 py-2.5 rounded-2xl bg-white text-gray-400 text-sm font-bold transition-all duration-300 border border-transparent shadow-sm">
                01/13 <span class="text-[10px] block opacity-60">週二</span>
            </button>
        </div>
    </nav>

    <!-- AI Day Suggestion Feature -->
    <div class="px-6 mt-6 max-w-2xl mx-auto">
        <button onclick="getAIDayTip()" class="w-full py-4 rounded-3xl bg-gradient-to-br from-[#ffafcc]/20 to-[#bde0fe]/20 border border-white/50 text-[#5d5353] font-bold text-sm flex items-center justify-center card-shadow hover:scale-[1.02] active:scale-95 transition-all">
            <i data-lucide="sparkles" class="w-4 h-4 mr-2 text-pink-400"></i> ✨ 獲取今日 AI 智慧小貼士
        </button>
        <div id="ai-suggestion-box" class="hidden mt-4 p-5 bg-white border border-pink-50 rounded-[2rem] text-xs text-gray-500 leading-relaxed card-shadow fade-in">
            <!-- AI Content injected here -->
        </div>
    </div>

    <!-- Main Itinerary Cards -->
    <main class="px-6 mt-8 max-w-2xl mx-auto">
        <div id="itinerary-container" class="space-y-8 relative timeline-line">
            <!-- JS will inject cards here -->
        </div>

        <!-- Static Tips Footer -->
        <div class="mt-16 p-8 rounded-[2.5rem] bg-white border border-pink-50 card-shadow text-center">
            <h3 class="flex items-center justify-center text-lg font-bold text-pink-300 mb-4">
                <i data-lucide="heart" class="w-5 h-5 mr-2 fill-pink-300"></i> 旅行小筆記
            </h3>
            <div class="text-sm space-y-4 text-gray-400 italic">
                <p>「這趟旅行是送給自己最好的禮物。」</p>
                <div class="flex justify-center space-x-4 opacity-50">
                    <i data-lucide="camera" class="w-4 h-4"></i>
                    <i data-lucide="coffee" class="w-4 h-4"></i>
                    <i data-lucide="shopping-bag" class="w-4 h-4"></i>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for AI Details -->
    <div id="ai-modal" class="fixed inset-0 bg-gray-900/30 hidden z-[100] flex items-end sm:items-center justify-center p-0 sm:p-6 backdrop-blur-sm">
        <div class="bg-white w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2.5rem] p-10 card-shadow fade-in">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <span class="text-[10px] text-pink-300 font-bold tracking-widest uppercase">Spot Insight</span>
                    <h3 id="modal-title" class="text-2xl font-bold text-gray-700"></h3>
                </div>
                <button onclick="closeModal()" class="p-2 bg-gray-50 rounded-full text-gray-300 hover:text-pink-300 transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div id="modal-content" class="text-sm text-gray-500 space-y-5 leading-relaxed">
                <!-- AI dynamic content -->
            </div>
            <button onclick="closeModal()" class="mt-10 w-full py-4 bg-gradient-to-r from-pink-200 to-pink-300 text-white rounded-2xl font-bold shadow-lg shadow-pink-100">
                明白囉，出發！
            </button>
        </div>
    </div>

    <script>
        const apiKey = ""; // 執行環境會自動提供
        let currentSelectedDate = '01/09';

        const itineraryData = {
            '01/09': [
                { time: '08:00', title: '桃園國際機場', note: '第二航廈，準備出發！', type: 'transport' },
                { time: '10:00', title: '福岡機場國際線', note: '抵達九州福岡', type: 'transport' },
                { time: '11:15', title: 'Via Inn 博多口站前', note: '寄存行李及 Check-in', type: 'hotel' },
                { time: '11:45', title: '麵屋兼虎', note: '博多DEITOS店 濃厚沾麵', type: 'food' },
                { time: '12:45', title: 'FUGLEN FUKUOKA', note: '源自奧斯陸的北歐咖啡', type: 'food' },
                { time: '14:30', title: '博多名代 吉塚鰻魚屋', note: '百年老字號美味', type: 'food' },
                { time: '15:45', title: '櫛田神社', note: '福岡市民的信仰中心', type: 'sight' },
                { time: '16:30', title: '川端通商店街', note: '博多最古老的商店街', type: 'shop' },
                { time: '17:30', title: '天神南區域', note: '天神地下街與百貨周邊', type: 'shop' },
                { time: '18:00', title: 'KBF', note: '時尚日系簡約女裝', type: 'shop' },
                { time: '18:30', title: 'ガチャガチャの森', note: '天神西通り店 扭蛋天堂', type: 'shop' },
                { time: '19:00', title: 'SHIRO 岩田屋店', note: '日系天然香氣與彩妝', type: 'shop' },
                { time: '19:40', title: 'mont-bell 福岡天神', note: '專業戶外用品品牌', type: 'shop' },
                { time: '20:20', title: 'dacō 福岡', note: '人氣現烤小巧麵包', type: 'food' },
                { time: '20:45', title: 'NONE TOO SOON', note: '精緻生活物件選物店', type: 'shop' },
                { time: '21:15', title: 'Yakiniku AGITO HIRAO', note: '美味燒肉夜晚', type: 'food' }
            ],
            '01/10': [
                { time: '08:00', title: '博多出發', note: '開啟由布院一日遊', type: 'transport' },
                { time: '12:00', title: '由布釜飯「心」', note: '金鱗湖本店 必吃地雞釜飯', type: 'food' },
                { time: '13:15', title: '金鱗湖', note: '夢幻的晨霧與湖光', type: 'sight' },
                { time: '13:45', title: '水上鳥居 (天祖神社)', note: '湖畔靜謐風景', type: 'sight' },
                { time: '14:15', title: '湯布院貓頭鷹之森林', note: '與可愛生物互動', type: 'sight' },
                { time: '14:45', title: '湯布院花卉村', note: '童話般的小徑', type: 'sight' },
                { time: '15:30', title: '湯布珈琲', note: '悠閒的小休時刻', type: 'food' },
                { time: '16:00', title: '日本茶5toku', note: '職人精神抹茶專賣', type: 'food' },
                { time: '16:30', title: '鞠智 cucuchi', note: '現烤銅鑼燒與咖啡', type: 'food' },
                { time: '17:00', title: '由布院 Milch', note: '半熟起司蛋糕', type: 'food' },
                { time: '17:20', title: '可麗露 Carandonel', note: '法式優雅甜點', type: 'food' },
                { time: '20:00', title: '博多牛腸鍋 大山', note: 'KITTE博多店 濃厚味噌', type: 'food' }
            ],
            '01/11': [
                { time: '08:00', title: 'Via Inn 出發', note: '前往太宰府區域', type: 'transport' },
                { time: '09:00', title: '寶滿宮 竈門神社', note: '絕美求緣與時尚守護符', type: 'sight' },
                { time: '10:15', title: '天開稻荷神社', note: '登高望遠開運祈福', type: 'sight' },
                { time: '11:00', title: '太宰府天滿宮', note: '供奉學問之神', type: 'sight' },
                { time: '12:15', title: 'YAMAYA BASE', note: '特製明太子小吃', type: 'food' },
                { time: '14:30', title: '麵屋Gaga 天神店', note: '小郡拉麵名店', type: 'food' },
                { time: '15:30', title: '藍瓶咖啡 福岡天神', note: '結合神社建築美學', type: 'food' },
                { time: '16:30', title: '警固神社 鳥居', note: '市中心的寧靜一角', type: 'sight' },
                { time: '17:00', title: 'dacō 福岡', note: '美味麵包補貨', type: 'food' },
                { time: '17:45', title: 'Full full', note: '招牌明太子法國麵包', type: 'food' },
                { time: '18:30', title: 'Mina 天神', note: '熱門日系生活品牌逛街', type: 'shop' },
                { time: '21:00', title: 'Hakata Motsushō', note: '博多牛腸燒', type: 'food' }
            ],
            '01/12': [
                { time: '10:00', title: 'MARKS & WEB', note: '日系生活香氛與洗沐', type: 'shop' },
                { time: '10:45', title: 'BAUM アミュプラザ博多', note: '精緻年輪蛋糕', type: 'food' },
                { time: '11:30', title: 'Fuk Coffee', note: '以旅行為主題的職人咖啡', type: 'food' },
                { time: '12:30', title: '博多 祇園 鐵鍋煎餃', note: '酥脆多汁的在地美食', type: 'food' },
                { time: '14:00', title: '大濠公園', note: '在城市綠肺悠閒漫步', type: 'sight' },
                { time: '15:00', title: 'FUK COFFEE Parks', note: '公園旁分店限定氛圍', type: 'food' },
                { time: '16:00', title: '福岡城跡', note: '舞鶴公園的古城氣息', type: 'sight' },
                { time: '17:30', title: '赤坂煙草店', note: '歷史建築中的特色探索', type: 'shop' },
                { time: '19:30', title: '燒肉上', note: '精緻燒肉盛宴', type: 'food' },
                { time: '21:00', title: '大賀藥局 博多口店', note: '最後採購好去處', type: 'shop' }
            ],
            '01/13': [
                { time: '09:00', title: 'Coffee County Fukuoka', note: '深邃且迷人的自家烘焙', type: 'food' },
                { time: '10:00', title: 'Dacomecca', note: '博多站旁最夯麵包店', type: 'food' },
                { time: '11:30', title: 'Menya ISHII', note: '精緻系淡麗拉麵', type: 'food' },
                { time: '12:45', title: '博多雞soba 建 TATERU', note: '金黃色澤濃厚雞白湯', type: 'food' },
                { time: '14:00', title: '前往福岡機場', note: '帶著滿滿的戰利品回家', type: 'transport' }
            ]
        };

        const icons = { transport: 'plane', food: 'utensils-crosshair', hotel: 'bed', sight: 'camera', shop: 'shopping-bag' };
        const iconColors = { transport: 'text-blue-300', food: 'text-pink-300', hotel: 'text-purple-300', sight: 'text-green-300', shop: 'text-yellow-400' };

        // --- Gemini AI Logic ---
        async function fetchGemini(prompt) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: "你是一位專為女性旅客提供建議的智慧導遊，語氣甜美溫和、專業且細心。請使用繁體中文，針對日本九州旅遊給予極具美感與實用性的建議（如：最佳拍照時機、穿搭、限量必買等）。" }] }
            };

            let retries = 0;
            while (retries < 5) {
                try {
                    const response = await fetch(url, { method: 'POST', body: JSON.stringify(payload) });
                    const result = await response.json();
                    return result.candidates?.[0]?.content?.parts?.[0]?.text;
                } catch (e) {
                    retries++;
                    await new Promise(r => setTimeout(r, Math.pow(2, retries) * 1000));
                }
            }
            return "糟糕，連線稍微休息了一下，請稍後再試試喔！";
        }

        async function getAIDayTip() {
            const box = document.getElementById('ai-suggestion-box');
            box.classList.remove('hidden');
            box.innerHTML = `<div class="flex justify-center py-6"><div class="dot-flashing"></div></div>`;
            
            const daySpots = itineraryData[currentSelectedDate].map(i => i.title).join('、');
            const prompt = `這是今天的福岡行程：${daySpots}。請給我一段約 150 字的溫暖智慧建議，包含今天的穿搭色系推薦、哪裡最好拍，以及美食的隱藏亮點。`;
            
            const response = await fetchGemini(prompt);
            box.innerHTML = `<div class="font-bold text-pink-300 mb-2 flex items-center"><i data-lucide="stars" class="w-3 h-3 mr-1"></i> Gemini 智慧分析</div>${response.replace(/\n/g, '<br>')}`;
            lucide.createIcons();
        }

        async function getPlaceDetails(title) {
            const modal = document.getElementById('ai-modal');
            const modalContent = document.getElementById('modal-content');
            document.getElementById('modal-title').innerText = title;
            modalContent.innerHTML = `<div class="flex justify-center py-12"><div class="dot-flashing"></div></div>`;
            modal.classList.remove('hidden');

            const prompt = `針對「${title}」，提供 3 個 ✨ 智慧重點：1. 一個充滿美感的小知識。2. 這裡最推薦拍照的一個角落或必買單品。3. 一句在這個地點能派上用場的日語（附中文說明）。`;
            const response = await fetchGemini(prompt);
            modalContent.innerHTML = response.replace(/\n/g, '<br>');
            lucide.createIcons();
        }

        function closeModal() { document.getElementById('ai-modal').classList.add('hidden'); }

        // --- UI Logic ---
        function switchDate(date) {
            currentSelectedDate = date;
            document.querySelectorAll('.date-tab').forEach(t => t.classList.remove('tab-active'));
            document.getElementById(`tab-${date}`).classList.add('tab-active');
            document.getElementById('ai-suggestion-box').classList.add('hidden');

            const container = document.getElementById('itinerary-container');
            container.innerHTML = '';

            itineraryData[date].forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'flex items-start z-10 fade-in';
                card.style.animationDelay = `${index * 0.08}s`;

                card.innerHTML = `
                    <div class="relative z-20">
                        <div class="w-12 h-12 rounded-full flex items-center justify-center bg-white border border-pink-50 shadow-sm">
                            <i data-lucide="${icons[item.type]}" class="w-5 h-5 ${iconColors[item.type]}"></i>
                        </div>
                    </div>
                    <div class="ml-4 flex-1 bg-white p-6 rounded-[1.8rem] border border-pink-50 card-shadow group relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-3 opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="getPlaceDetails('${item.title}')" class="p-2 bg-pink-50 rounded-xl text-pink-300 hover:bg-pink-100 transition-all">
                                <i data-lucide="plus-circle" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-[10px] font-bold px-2 py-0.5 rounded-lg bg-gray-50 text-gray-400 tracking-wider">${item.time}</span>
                        </div>
                        <h4 class="font-bold text-gray-700 text-lg mb-1 leading-tight">${item.title}</h4>
                        <p class="text-xs text-gray-400 font-medium">${item.note}</p>
                    </div>
                `;
                container.appendChild(card);
            });
            lucide.createIcons();
        }

        window.onload = () => { switchDate('01/09'); };
    </script>
</body>
</html>